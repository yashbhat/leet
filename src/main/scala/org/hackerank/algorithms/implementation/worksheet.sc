(1 until n).scanLeft((5, 2))((x, y) => (x._2 * 3, (x._2 * 3)/2)).map(_._2).sum